<html>

<head>
	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-hQpvDQiCJaD2H465dQfA717v7lu5qHWtDbWNPvaTJ0ID5xnPUlVXnKzq7b8YUkbN" crossorigin="anonymous">
	<script   src="https://code.jquery.com/jquery-2.2.3.min.js"   integrity="sha256-a23g1Nt4dtEYOj7bR+vTu7+T8VP13humZFBJNIYoEJo="   crossorigin="anonymous"></script>

	<script src="../webpd.js"></script>
	<script src="../utils.js"></script>

<body style="background-color: 0; margin: 0; padding: 0; font-family: Verdana; font-size: 10px">

<canvas id="canvas" width="100" height="100" draggable="false"></canvas>

<div style="position: fixed; top: 0; right: 0; opacity: 0.9; background-color: 0; color: #fff">
	<input id="slider1" type="range" min="0" max="100" value="50">
	<input id="x1" type="range" min="0" max="10" value="4">
	<input id="x2" type="range" min="0" max="10" value="5">
</div>

<script>

// https://api.github.com/repos/mgsx-dev/algo-viz/commits

commitsFlow = []

$(function() {
	$.get('patch.pd', function(patchStr) {
	  patch = Pd.loadPatch(patchStr)
	  Pd.start()
	})
});

$(function() {
	url = "https://api.github.com/repos/mgsx-dev/algo-viz/commits"
	url = "https://api.github.com/repos/b2renger/PdDroidPublisher/commits"

	$.get(url, function(commits) {
		console.log(commits[0])
		console.log(commits.length)
		for(var i in commits)
		{
			commit = commits[i]
			// console.log(commit.sha)
			// console.log(" - " + commit.author.login)
			// console.log(" - " + commit.commit.author.name + " " + commit.commit.author.date)
			// console.log(" - " + commit.commit.committer.name)

			// console.log(commit.commit.author.date);
			// console.log(new Date(commit.commit.author.date));
			// console.log(JSON.parse(commit.commit.author.date))

			commitsFlow.push({id: commit.author.id, author: commit.commit.author.name, date: new Date(commit.commit.author.date)})
		}
	  	start()
	})
});



var prev = null
function start()
{
	var c = commitsFlow.pop()
	if(c == null)
	{
		return
	}
	if(prev != null)
	{
		dif = c.date - prev.date
		console.log(c.date)
		console.log(prev.date)
		console.log(dif) // ms
		console.log(dif / 60000) // minutes

		window.setTimeout(start, dif / (60000 / 4))
	}
	else
	{
		window.setTimeout(start, 0)
	}
	console.log(c.id) // ms
	Pd.send("commit", [c.id % 1000 + 1000])
	prev = c
	
}

</script>

</body>


</html>




